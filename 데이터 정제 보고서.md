# 한국인 얼굴 데이터 셋을 이용한 finetuning
## 데이터 수집 방법
### 데이터 출처
- 공개 데이터 셋.
- AI HUB에서 제공하는 한국인 안면 이미지 공개 데이터 셋.
- 한국인 안면 이미지 URL : https://aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=realm&dataSetSn=83\n
- 사용 허가 요청 필요.

### 데이터 수집 주기
- 데이터 수집은 한번 진행 되었으며, 이후 추가적인 데이터 수집은 없음.


## 데이터 전처리 과정
### 데이터 정제
- 이미지 정보
  - 저, 중, 고화질 이미지가 각각 동일 인물 400명의 데이터 셋.
  - 얼굴 각도 20종，조명 30종，액세서리 6종，표정 3종, 해상도 3종으로 **1명당 약 32,400장**의 데이터 셋으로 구축되어 있음.
  - 해상도 : 고해상도(864x576)，중해상도(346x230)，저해상도 (173x115)

- 이미지 품질 검토
  - 조명으로 인하여 얼굴 자체가 보이지 않는 사진은 제거. ex) L6 , L7, L10 ...
  - 얼굴 등록을 할 때, 사용하지 않는 각도 제거. ex) C14, C15, C17, C18
  - 찡그린 이미지 제거. ex) E03

- 이미지 분류
  - 400명의 데이터 중 100명의 데이터를 랜덤으로 추출.
  - 100명의 데이터 중 품질이 저하된 부분은 제거하고 얼굴 각도 16종, 조명 14종, 액세서리 6종, 표정 2종으로 각각의 해상도 마다 1명당 150장씩 뽑아 **train : valid = 0.8 : 0.2** 비율로 분할.
  - test셋은 100명 중 50명을 무작위로 뽑아 **1명당 50장**의 무작위 얼굴 이미지를 추출.
  
- 중복데이터 처리
  - 한 ID값을 가진 이미지 화질이 저, 중, 고화질로 나뉘어져 있어 **중복 처리는 시행하지 않음**.
 

## 데이터 변환
- 이미지 크기 조정
  - 모든 이미지를 size를 160x160 으로 조정.
  - 모든 이미지를 파이토치 tensor로 변환함. **(Channel, Height, Width)** 형태의 텐서로 변환.
  - 모든 이미지를 평균 = [0.5, 0.5, 0.5]와 표준편차 = [0.5, 0.5, 0.5]로 정규화. (**픽셀값 => [-1,1]사이**)

- 라벨링
  - 처음 압축 해제할 때 가지고 있던 고유 ID값을 라벨로 붙여서 사용.

## 데이터 구조
- 디렉터리 구조
  ```
  modeling
  ├─ .ipynb_checkpoints
  │  ├─ datacleansing-checkpoint.**ipynb**
  │  └─ 데이터정제보고서-checkpoint.md
  ├─ datacleansing.ipynb
  ├─ datasets
  ├─ facenet_pytorch.ipynb
  ├─ low_data
  ├─ middle_data
  ├─ high_data
  ├─ test
  │  ├─ 19070922
  │  │  ├─ 19070922_S001_L1_E01_C1.jpg
  │  │  ├─ 19070922_S001_L1_E01_C2.jpg
  │  ├─ 19071032
  │  │  ├─ 19071032_S003_L8_E02_C1.jpg
  │  │  ├─ 19071032_S003_L8_E02_C2.jpg
  ├─ train
  │  ├─ 19070922
  │  │  ├─ 19070922_S001_L1_E01_C1.jpg
  │  │  ├─ 19070922_S001_L1_E01_C2.jpg
  │  ├─ 19071032
  │  │  ├─ 19071032_S003_L8_E02_C1.jpg
  │  │  ├─ 19071032_S003_L8_E02_C2.jpg
  ├─ valid
  │  ├─ 19070922
  │  │  ├─ 19070922_S001_L1_E01_C1.jpg
  │  │  ├─ 19070922_S001_L1_E01_C2.jpg
  │  ├─ 19071032
  │  │  ├─ 19071032_S003_L8_E02_C1.jpg
  │  │  ├─ 19071032_S003_L8_E02_C2.jpg
  └─ 데이터 정제 보고서.md
  ```
- 파일명 규칙
  - 파일명은 '**고유ID값_액세서리_조명_표정_인덱스.jpg**' 형식으로 구성되어 있으며 '*19070922_S001_L1_E01_C1.jpg*' 는 **'19070922' ID값**을 가진 사람의 첫번째 얼굴 이미지.
  - test, train, valid 폴더 안의 파일은 이름만 같고 다른 이미지로 구성.

### 데이터 저장 형식
- 이미지 형식
  - 모든 이미지는 JPG 형식


### 데이터 개인정보 보호
- 데이터는 익명화된 형태로 저장됨.
- 출처 : AI HUB , 한국과학기술연구원 , 한국지능정보사회진흥원
  

### 데이터 수집 및 전처리 과정에 사용된 모든 코드는 GitHub 리포지토리에 공개하였으며, README 파일에 상세한 설명을 포함했습니다